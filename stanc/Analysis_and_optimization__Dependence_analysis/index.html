<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Analysis_and_optimization__Dependence_analysis (stanc.Analysis_and_optimization__Dependence_analysis)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">stanc</a> &#x00BB; Analysis_and_optimization__Dependence_analysis</nav><h1>Module <code>Analysis_and_optimization__Dependence_analysis</code></h1></header><aside><p>~~~~~ TODO ~~~~~ * The interfaces are currently messed up. I think part of the solution is to change the signature of reaching_definitions_mfp in Monotone_framework, which currently requires the full program but shouldn't need the full program. As it stands, stmt_map_dependency_graph does not include data dependencies at all, since it can't use reaching deps, and prog_dependency graph only builds the graph for log_prob, but the user isn't guaranteed to be using the same labeling scheme. * Currently, dependencies on global or uninitialized data are written as depending on node '0'. This should probably be option or some type that indicates global dependence. * Indexed variables are currently handled as monoliths * No probabilistic dependency, I'll do that elsewhere *</p></aside><dl><dt class="spec type" id="type-node_dep_info"><a href="#type-node_dep_info" class="anchor"></a><code><span class="keyword">type</span> node_dep_info</code><code> = </code><code>{</code><table class="record"><tr id="type-node_dep_info.predecessors" class="anchored"><td class="def field"><a href="#type-node_dep_info.predecessors" class="anchor"></a><code>predecessors : <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a> Core_kernel.Set.Poly.t</span>;</code></td></tr><tr id="type-node_dep_info.parents" class="anchored"><td class="def field"><a href="#type-node_dep_info.parents" class="anchor"></a><code>parents : <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a> Core_kernel.Set.Poly.t</span>;</code></td></tr><tr id="type-node_dep_info.reaching_defn_entry" class="anchored"><td class="def field"><a href="#type-node_dep_info.reaching_defn_entry" class="anchor"></a><code>reaching_defn_entry : <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-reaching_defn">Analysis_and_optimization.Dataflow_types.reaching_defn</a> Core_kernel.Set.Poly.t</span>;</code></td></tr><tr id="type-node_dep_info.reaching_defn_exit" class="anchored"><td class="def field"><a href="#type-node_dep_info.reaching_defn_exit" class="anchor"></a><code>reaching_defn_exit : <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-reaching_defn">Analysis_and_optimization.Dataflow_types.reaching_defn</a> Core_kernel.Set.Poly.t</span>;</code></td></tr><tr id="type-node_dep_info.meta" class="anchored"><td class="def field"><a href="#type-node_dep_info.meta" class="anchor"></a><code>meta : <a href="../Middle/Location_span/index.html#type-t">Middle.Location_span.t</a>;</code></td></tr></table><code>}</code></dt><dd><p>Sufficient information about each node to build the dependency graph.</p><p>Label dependence doesn't need the exit RD set, but variable dependence does.</p></dd></dl><dl><dt class="spec value" id="val-node_immediate_dependencies"><a href="#val-node_immediate_dependencies" class="anchor"></a><code><span class="keyword">val</span> node_immediate_dependencies : <span><span>(<a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>, <span><span>(<a href="../Middle__Expr/Typed/index.html#type-t">Middle.Expr.Typed.t</a>, <a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>)</span> <a href="../Middle__Stmt/Fixed/Pattern/index.html#type-t">Middle.Stmt.Fixed.Pattern.t</a></span> * <a href="index.html#type-node_dep_info">node_dep_info</a>)</span> Core_kernel.Map.Poly.t</span> <span>&#45;&gt;</span> <span>?&#8288;blockers:<span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-vexpr">Analysis_and_optimization.Dataflow_types.vexpr</a> Core_kernel.Set.Poly.t</span></span> <span>&#45;&gt;</span> <a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a> <span>&#45;&gt;</span> <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a> Core_kernel.Set.Poly.t</span></code></dt><dd><p>Given dependency information for each node, find the 'immediate' dependencies of a node, where 'immediate' means the first-degree control flow parents and the reachable definitions of RHS variables.</p></dd></dl><dl><dt class="spec value" id="val-node_dependencies"><a href="#val-node_dependencies" class="anchor"></a><code><span class="keyword">val</span> node_dependencies : <span><span>(<a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>, <span><span>(<a href="../Middle__Expr/Typed/index.html#type-t">Middle.Expr.Typed.t</a>, <a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>)</span> <a href="../Middle__Stmt/Fixed/Pattern/index.html#type-t">Middle.Stmt.Fixed.Pattern.t</a></span> * <a href="index.html#type-node_dep_info">node_dep_info</a>)</span> Core_kernel.Map.Poly.t</span> <span>&#45;&gt;</span> <a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a> <span>&#45;&gt;</span> <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a> Core_kernel.Set.Poly.t</span></code></dt><dd><p>Given dependency information for each node, find all of the dependencies of a single node.</p></dd></dl><dl><dt class="spec value" id="val-node_vars_dependencies"><a href="#val-node_vars_dependencies" class="anchor"></a><code><span class="keyword">val</span> node_vars_dependencies : <span><span>(<a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>, <span><span>(<a href="../Middle__Expr/Typed/index.html#type-t">Middle.Expr.Typed.t</a>, <a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>)</span> <a href="../Middle__Stmt/Fixed/Pattern/index.html#type-t">Middle.Stmt.Fixed.Pattern.t</a></span> * <a href="index.html#type-node_dep_info">node_dep_info</a>)</span> Core_kernel.Map.Poly.t</span> <span>&#45;&gt;</span> <span>?&#8288;blockers:<span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-vexpr">Analysis_and_optimization.Dataflow_types.vexpr</a> Core_kernel.Set.Poly.t</span></span> <span>&#45;&gt;</span> <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-vexpr">Analysis_and_optimization.Dataflow_types.vexpr</a> Core_kernel.Set.Poly.t</span> <span>&#45;&gt;</span> <a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a> <span>&#45;&gt;</span> <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a> Core_kernel.Set.Poly.t</span></code></dt><dd><p>Given dependency information for each node, find all of the dependencies of a set of variables at single node.</p><p>'blockers' are variables which will not be traversed.</p></dd></dl><dl><dt class="spec value" id="val-build_dep_info_map"><a href="#val-build_dep_info_map" class="anchor"></a><code><span class="keyword">val</span> build_dep_info_map : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Stmt/Located/index.html#type-t">Middle.Stmt.Located.t</a> <span>&#45;&gt;</span> <span><span>(<a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>, <span><span>(<a href="../Middle__Expr/Typed/index.html#type-t">Middle.Expr.Typed.t</a>, <a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>)</span> <a href="../Middle__Stmt/Fixed/Pattern/index.html#type-t">Middle.Stmt.Fixed.Pattern.t</a></span> * <a href="index.html#type-node_dep_info">node_dep_info</a>)</span> Core_kernel.Map.Poly.t</span></code></dt><dd><p>Build the dependency information for each node in the log_prob section of a program</p></dd></dl><dl><dt class="spec value" id="val-log_prob_build_dep_info_map"><a href="#val-log_prob_build_dep_info_map" class="anchor"></a><code><span class="keyword">val</span> log_prob_build_dep_info_map : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <span><span>(<a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>, <span><span>(<a href="../Middle__Expr/Typed/index.html#type-t">Middle.Expr.Typed.t</a>, <a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>)</span> <a href="../Middle__Stmt/Fixed/Pattern/index.html#type-t">Middle.Stmt.Fixed.Pattern.t</a></span> * <a href="index.html#type-node_dep_info">node_dep_info</a>)</span> Core_kernel.Map.Poly.t</span></code></dt><dd><p>Build the dependency information for each node in the log_prob section of a program</p></dd></dl><dl><dt class="spec value" id="val-all_node_dependencies"><a href="#val-all_node_dependencies" class="anchor"></a><code><span class="keyword">val</span> all_node_dependencies : <span><span>(<a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>, <span><span>(<a href="../Middle__Expr/Typed/index.html#type-t">Middle.Expr.Typed.t</a>, <a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>)</span> <a href="../Middle__Stmt/Fixed/Pattern/index.html#type-t">Middle.Stmt.Fixed.Pattern.t</a></span> * <a href="index.html#type-node_dep_info">node_dep_info</a>)</span> Core_kernel.Map.Poly.t</span> <span>&#45;&gt;</span> <span><span>(<a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>, <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a> Core_kernel.Set.Poly.t</span>)</span> Core_kernel.Map.Poly.t</span></code></dt><dd><p>Given dependency information for each node, find all of the dependencies of all nodes, effectively building the dependency graph.</p><p>This is more efficient than calling node_dependencies on each node individually.</p></dd></dl><dl><dt class="spec value" id="val-log_prob_dependency_graph"><a href="#val-log_prob_dependency_graph" class="anchor"></a><code><span class="keyword">val</span> log_prob_dependency_graph : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <span><span>(<a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a>, <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a> Core_kernel.Set.Poly.t</span>)</span> Core_kernel.Map.Poly.t</span></code></dt><dd><p>Build the dependency graph for the log_prob section of a program, where labels correspond to the labels built by statement_map.</p></dd></dl><dl><dt class="spec value" id="val-reaching_defn_lookup"><a href="#val-reaching_defn_lookup" class="anchor"></a><code><span class="keyword">val</span> reaching_defn_lookup : <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-reaching_defn">Analysis_and_optimization.Dataflow_types.reaching_defn</a> Core_kernel.Set.Poly.t</span> <span>&#45;&gt;</span> <a href="../Analysis_and_optimization/Dataflow_types/index.html#type-vexpr">Analysis_and_optimization.Dataflow_types.vexpr</a> <span>&#45;&gt;</span> <span><a href="../Analysis_and_optimization/Dataflow_types/index.html#type-label">Analysis_and_optimization.Dataflow_types.label</a> Core_kernel.Set.Poly.t</span></code></dt><dt class="spec value" id="val-mir_uninitialized_variables"><a href="#val-mir_uninitialized_variables" class="anchor"></a><code><span class="keyword">val</span> mir_uninitialized_variables : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <span><span>(<a href="../Middle/Location_span/index.html#type-t">Middle.Location_span.t</a> * string)</span> Core_kernel.Set.Poly.t</span></code></dt><dd><p>Produce a list of uninitialized variables and their label locations, from the flowgraph starting at the given statement</p></dd></dl></div></body></html>