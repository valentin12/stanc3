<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Analysis_and_optimization__Optimize (stanc.Analysis_and_optimization__Optimize)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">stanc</a> &#x00BB; Analysis_and_optimization__Optimize</nav><h1>Module <code>Analysis_and_optimization__Optimize</code></h1></header><dl><dt class="spec value" id="val-function_inlining"><a href="#val-function_inlining" class="anchor"></a><code><span class="keyword">val</span> function_inlining : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Inline all functions except for ones with forward declarations (e.g. recursive functions, mutually recursive functions, and functions without a definition</p></dd></dl><dl><dt class="spec value" id="val-static_loop_unrolling"><a href="#val-static_loop_unrolling" class="anchor"></a><code><span class="keyword">val</span> static_loop_unrolling : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Unroll all for-loops with constant bounds, as long as they do not contain break or continue statements in their body at the top level</p></dd></dl><dl><dt class="spec value" id="val-one_step_loop_unrolling"><a href="#val-one_step_loop_unrolling" class="anchor"></a><code><span class="keyword">val</span> one_step_loop_unrolling : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Unroll all loops for one iteration, as long as they do not contain break or continue statements in their body at the top level</p></dd></dl><dl><dt class="spec value" id="val-list_collapsing"><a href="#val-list_collapsing" class="anchor"></a><code><span class="keyword">val</span> list_collapsing : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Remove redundant SList constructors from the Mir that might have been introduced by other optimizations</p></dd></dl><dl><dt class="spec value" id="val-block_fixing"><a href="#val-block_fixing" class="anchor"></a><code><span class="keyword">val</span> block_fixing : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Make sure that SList constructors directly under if, for, while or fundef constructors are replaced with Block constructors. This should probably be run before we generate code.</p></dd></dl><dl><dt class="spec value" id="val-constant_propagation"><a href="#val-constant_propagation" class="anchor"></a><code><span class="keyword">val</span> constant_propagation : <span>?&#8288;preserve_stability:bool</span> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Propagate constant values through variable assignments</p></dd></dl><dl><dt class="spec value" id="val-expression_propagation"><a href="#val-expression_propagation" class="anchor"></a><code><span class="keyword">val</span> expression_propagation : <span>?&#8288;preserve_stability:bool</span> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Propagate arbitrary expressions through variable assignments. This can be useful for opening up new possibilities for partial evaluation. It should be followed by some CSE or lazy code motion pass, however.</p></dd></dl><dl><dt class="spec value" id="val-copy_propagation"><a href="#val-copy_propagation" class="anchor"></a><code><span class="keyword">val</span> copy_propagation : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Propagate copies of variables through assignments.</p></dd></dl><dl><dt class="spec value" id="val-dead_code_elimination"><a href="#val-dead_code_elimination" class="anchor"></a><code><span class="keyword">val</span> dead_code_elimination : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Eliminate semantically redundant code branches. This includes removing redundant assignments (because they will be overwritten) and removing redundant code in program branches that will never be reached.</p></dd></dl><dl><dt class="spec value" id="val-partial_evaluation"><a href="#val-partial_evaluation" class="anchor"></a><code><span class="keyword">val</span> partial_evaluation : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Partially evaluate expressions in the program. This includes simplification using algebraic identities of logical and arithmetic operators as well as Stan math functions.</p></dd></dl><dl><dt class="spec value" id="val-lazy_code_motion"><a href="#val-lazy_code_motion" class="anchor"></a><code><span class="keyword">val</span> lazy_code_motion : <span>?&#8288;preserve_stability:bool</span> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Perform partial redundancy elmination using the lazy code motion algorithm. This subsumes common subexpression elimination and loop-invariant code motion.</p></dd></dl><dl><dt class="spec value" id="val-optimize_ad_levels"><a href="#val-optimize_ad_levels" class="anchor"></a><code><span class="keyword">val</span> optimize_ad_levels : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Assign the optimal ad-levels to local variables. That means, make sure that variables only ever get treated as autodiff variables if they have some dependency on a parameter</p></dd></dl><dl><dt class="spec value" id="val-allow_uninitialized_decls"><a href="#val-allow_uninitialized_decls" class="anchor"></a><code><span class="keyword">val</span> allow_uninitialized_decls : <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Marks Decl types such that, if the first assignment after the decl assigns to the full object, allow the object to be constructed but not uninitialized.</p></dd></dl><dl><dt class="spec type" id="type-optimization_settings"><a href="#type-optimization_settings" class="anchor"></a><code><span class="keyword">type</span> optimization_settings</code><code> = </code><code>{</code><table class="record"><tr id="type-optimization_settings.function_inlining" class="anchored"><td class="def field"><a href="#type-optimization_settings.function_inlining" class="anchor"></a><code>function_inlining : bool;</code></td></tr><tr id="type-optimization_settings.static_loop_unrolling" class="anchored"><td class="def field"><a href="#type-optimization_settings.static_loop_unrolling" class="anchor"></a><code>static_loop_unrolling : bool;</code></td></tr><tr id="type-optimization_settings.one_step_loop_unrolling" class="anchored"><td class="def field"><a href="#type-optimization_settings.one_step_loop_unrolling" class="anchor"></a><code>one_step_loop_unrolling : bool;</code></td></tr><tr id="type-optimization_settings.list_collapsing" class="anchored"><td class="def field"><a href="#type-optimization_settings.list_collapsing" class="anchor"></a><code>list_collapsing : bool;</code></td></tr><tr id="type-optimization_settings.block_fixing" class="anchored"><td class="def field"><a href="#type-optimization_settings.block_fixing" class="anchor"></a><code>block_fixing : bool;</code></td></tr><tr id="type-optimization_settings.allow_uninitialized_decls" class="anchored"><td class="def field"><a href="#type-optimization_settings.allow_uninitialized_decls" class="anchor"></a><code>allow_uninitialized_decls : bool;</code></td></tr><tr id="type-optimization_settings.constant_propagation" class="anchored"><td class="def field"><a href="#type-optimization_settings.constant_propagation" class="anchor"></a><code>constant_propagation : bool;</code></td></tr><tr id="type-optimization_settings.expression_propagation" class="anchored"><td class="def field"><a href="#type-optimization_settings.expression_propagation" class="anchor"></a><code>expression_propagation : bool;</code></td></tr><tr id="type-optimization_settings.copy_propagation" class="anchored"><td class="def field"><a href="#type-optimization_settings.copy_propagation" class="anchor"></a><code>copy_propagation : bool;</code></td></tr><tr id="type-optimization_settings.dead_code_elimination" class="anchored"><td class="def field"><a href="#type-optimization_settings.dead_code_elimination" class="anchor"></a><code>dead_code_elimination : bool;</code></td></tr><tr id="type-optimization_settings.partial_evaluation" class="anchored"><td class="def field"><a href="#type-optimization_settings.partial_evaluation" class="anchor"></a><code>partial_evaluation : bool;</code></td></tr><tr id="type-optimization_settings.lazy_code_motion" class="anchored"><td class="def field"><a href="#type-optimization_settings.lazy_code_motion" class="anchor"></a><code>lazy_code_motion : bool;</code></td></tr><tr id="type-optimization_settings.optimize_ad_levels" class="anchored"><td class="def field"><a href="#type-optimization_settings.optimize_ad_levels" class="anchor"></a><code>optimize_ad_levels : bool;</code></td></tr><tr id="type-optimization_settings.preserve_stability" class="anchored"><td class="def field"><a href="#type-optimization_settings.preserve_stability" class="anchor"></a><code>preserve_stability : bool;</code></td></tr><tr id="type-optimization_settings.optimize_soa" class="anchored"><td class="def field"><a href="#type-optimization_settings.optimize_soa" class="anchor"></a><code>optimize_soa : bool;</code></td></tr></table><code>}</code></dt><dd><p>Interface for turning individual optimizations on/off. Useful for testing and for top-level interface flags.</p></dd></dl><dl><dt class="spec value" id="val-all_optimizations"><a href="#val-all_optimizations" class="anchor"></a><code><span class="keyword">val</span> all_optimizations : <a href="index.html#type-optimization_settings">optimization_settings</a></code></dt><dt class="spec value" id="val-no_optimizations"><a href="#val-no_optimizations" class="anchor"></a><code><span class="keyword">val</span> no_optimizations : <a href="index.html#type-optimization_settings">optimization_settings</a></code></dt></dl><dl><dt class="spec type" id="type-optimization_level"><a href="#type-optimization_level" class="anchor"></a><code><span class="keyword">type</span> optimization_level</code><code> = </code><table class="variant"><tr id="type-optimization_level.O0" class="anchored"><td class="def constructor"><a href="#type-optimization_level.O0" class="anchor"></a><code>| </code><code><span class="constructor">O0</span></code></td></tr><tr id="type-optimization_level.O1" class="anchored"><td class="def constructor"><a href="#type-optimization_level.O1" class="anchor"></a><code>| </code><code><span class="constructor">O1</span></code></td></tr><tr id="type-optimization_level.Oexperimental" class="anchored"><td class="def constructor"><a href="#type-optimization_level.Oexperimental" class="anchor"></a><code>| </code><code><span class="constructor">Oexperimental</span></code></td></tr></table></dt></dl><dl><dt class="spec value" id="val-level_optimizations"><a href="#val-level_optimizations" class="anchor"></a><code><span class="keyword">val</span> level_optimizations : <a href="index.html#type-optimization_level">optimization_level</a> <span>&#45;&gt;</span> <a href="index.html#type-optimization_settings">optimization_settings</a></code></dt><dt class="spec value" id="val-optimization_suite"><a href="#val-optimization_suite" class="anchor"></a><code><span class="keyword">val</span> optimization_suite : <span>?&#8288;settings:<a href="index.html#type-optimization_settings">optimization_settings</a></span> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a> <span>&#45;&gt;</span> <a href="../Middle__Program/Typed/index.html#type-t">Middle.Program.Typed.t</a></code></dt><dd><p>Perform all optimizations in this module on the MIR in an appropriate order.</p></dd></dl></div></body></html>